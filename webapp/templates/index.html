<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
  <meta name="apple-mobile-web-app-capable" content="yes">

  <title>Kadist Index Search</title>

  <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">


  <!-- local styles -->
  <link rel="stylesheet" media="screen" href="{{ url_for('static', filename='css/main.css') }}">

  <link rel="shortcut icon"                    href="{{ url_for('static', filename='images/favicon.ico') }}" type="image/x-icon"/>
  <link rel="apple-touch-icon"                 href="{{ url_for('static', filename='images/apple-touch-icon.png') }} "/>
  <link rel="apple-touch-icon" sizes="57x57"   href="{{ url_for('static', filename='images/apple-touch-icon-57x57.png') }}" />
  <link rel="apple-touch-icon" sizes="72x72"   href="{{ url_for('static', filename='images/apple-touch-icon-72x72.png') }}" />
  <link rel="apple-touch-icon" sizes="76x76"   href="{{ url_for('static', filename='images/apple-touch-icon-76x76.png') }}" />
  <link rel="apple-touch-icon" sizes="114x114" href="{{ url_for('static', filename='images/apple-touch-icon-114x114.png') }}" />
  <link rel="apple-touch-icon" sizes="120x120" href="{{ url_for('static', filename='images/apple-touch-icon-120x120.png') }}" />
  <link rel="apple-touch-icon" sizes="144x144" href="{{ url_for('static', filename='images/apple-touch-icon-144x144.png') }}" />
  <link rel="apple-touch-icon" sizes="152x152" href="{{ url_for('static', filename='images/apple-touch-icon-152x152.png') }}" />
  <link rel="apple-touch-icon" sizes="180x180" href="{{ url_for('static', filename='images/apple-touch-icon-180x180.png') }}" />



  <script>
    function formatTag(s) {
      return s.split('.')[0].replace('_', ' ');
    }
  </script>

</head>

<body class="body">

  <!-- Fixed navbar -->
  <nav class="navbar navbar-default navbar-fixed-top">
    <div class="container-fluid">
      <div class="navbar-header">
        <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
          <span class="sr-only">Toggle navigation</span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <img class="pull-left logo-img" src="{{ url_for('static', filename='images/kadist_logo.png') }}"><a href="/" class="navbar-brand logo-text">&nbsp;Kadist Index</a>
      </div>

        <div id="navbar" class="navbar-collapse collapse">
        <ul class="nav navbar-nav navbar-right">
          <li><a href="http://www.kapsul.org" target="_blank">Kapsul.org</a></li>
          <li><a href="http://www.kadist.org" target="_blank">Kadist.org</a></li>
        </ul>
      </div><!--/.navbar-collapse -->
    </div> <!-- container-fluid -->
  </nav>

  <div class="container-fluid">

    <div class="row">

      {% if results['facets'] %}
        <div class="col-sm-4 col-md-3 sidebar ">
          <form id="filter-section" method="post" action="/?q={{q}}" >            
            {% for facet in results['facets'] %}
              <h3 class="facet-title"><script>document.write(formatTag('{{facet}}'))</script></h3>
              <ul class="nav nav-sidebar">
                  {% for f in results['facets'][facet] %}
                  <div class="checkbox-primary">
                    <li>
                      <label>
                        <input type="checkbox" name="{{facet}}" value="{{f['key']}}"><a href="/?q={{q}}&filter_field={{facet}}&filter_value={{f['key']}}">{{f['key']}} ({{f['doc_count']}})</a></input>
                      </label>
                    </li>
                  </div>
                  {% endfor %}
            </ul>
            {% endfor %}
            {% if results['filter'] %}
              <a href="/?q={{q}}" class="btn btn-primary btn-sm">Clear Filter(s)</a>
            {% endif %}
            <input class="btn btn-primary btn-sm" type="submit" value="Filter">
          </form>
        </div>
      {% endif %}

      <div class="col-sm-8 col-sm-offset-4 col-md-9 col-md-offset-3">

        <!-- Search & results count Bar -->
        <div>
          {% if not q %}
            <div class="panel">
              <h1>Welcome to Kadist Art Discovery</h1>
                <p>Kadist's collections and productions reflect the global scope of contemporary
                art, and its programs develop collaborations with like-minded artists, curators and many art
                organizations around the world. Local programs in Kadist's hubs of Paris and San Francisco,
                including exhibitions, public events, residencies and educational initiatives, aim at creating
                vibrant conversations about contemporary art and ideas.</p>
            </div>
          {% endif %}

          <form role="search" method="get" class="search-form">
            <div class="input-group full-width">
              <input type="search" name="q" id="q" value="{% if q %}{{q}}{% endif %}" autocomplete="off" autocapitalize="off"
                autocorrect="off" class="search-field form-control" placeholder="Search">
              <span class="input-group-btn">
                <button class="btn btn-default" type="submit"><span class="glyphicon glyphicon-search" aria-hidden="true"></span></button>
              </span>
            </div>
          </form>

          {% if q %}
            <p class="search-result-header">
                {{results['count']}} results
                {% if results['filter'] %}
                  ({{results['filter'][0]}}:&nbsp;"{{results['filter'][1]}}")
                {% endif %}
                &nbsp;({{results['took']}} seconds)
            </p>
          {% endif %}
        </div>
        <!-- End Search & results count Bar -->



        <!-- Search Results -->
        {% if results['hits'] %}
          <article>
            <div id="columns">
                {% for hit in results['hits'] %}
                  {% if hit['imgurl'] %}
                    <div class="pin">
                      <img class="img" src="{{hit['imgurl']}}">
                        <table width="100%" border="0">
                          <tr>
                            <td><h4>&quot;{{hit['title']}}&quot;</h4></td>
                            <td align="right"><a href="/?q=_{{hit['id']}}"  title="More like this..."><span class="glyphicon glyphicon glyphicon-duplicate" aria-hidden="true"></span></a></td>
                          </tr>
                          <tr>
                            <td>
                              <a href="/?q={{hit['artist_name']}}">{{hit['artist_name']}}</a>
                            </td>
                            <td align="right">
                              {% if hit['year'] %}<a href="/?q={{hit['year']}}">{{hit['year']}}</a>{% endif %}
                            </td>
                          </tr>
                        </table>
                        <div class="details">
                        <hr/>
                        {% if hit['description'] %}
                          <h4><span class="glyphicon glyphicon-triangle-right" aria-hidden="true"></span>&nbsp;Work</h4>
                          <p>
                            {% if hit['worktype'] %}
                              <a href="/?q={{hit['worktype']}}"><h5>{{hit['worktype']}}</h5></a>
                            {% endif %}
                            {{hit['description']}}
                          </p>
                        {% endif %}

                        {% if hit['artist_description'] %}
                          <h4><span class="glyphicon glyphicon-triangle-right" aria-hidden="true"></span>&nbsp;Artist</h4></a>
                          <p>
                            {{hit['artist_description']}}
                          </p>
                        {% endif %}

                        {% if hit['major_tags'] or hit['minor_tags'] %}
                          <h4><span class="glyphicon glyphicon-triangle-right" aria-hidden="true"></span>&nbsp;Tags</h4>
                          {% for tag in hit['major_tags'] %}
                            <a href="/?q={{tag}}" title="{{tag}}"><span class="label label-primary tags"><script>document.write(formatTag('{{tag}}'))</script></span></a>
                          {% endfor %}

                          {% for tag in hit['minor_tags'] %}
                            <a href="/?q={{tag}}" title="{{tag}}"><span class="label label-info tags"><script>document.write(formatTag('{{tag}}'))</script></span></a>
                          {% endfor %}
                        {% endif %}
                      </div>
                    </div>
                  {% endif %}
                {% endfor %}
              </div> <!-- columns -->
          </article>
        {% endif %}
        <!-- Search Results -->

      </div> <!-- main -->
    </div> <!-- row -->
  </div> <!-- container -->


  <script src="//code.jquery.com/jquery-latest.min.js" type="text/javascript"></script>

  <script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>

  <script src="{{ url_for('static', filename='js/masonry.pkgd.min.js') }}" type="text/javascript"></script>
  <script src="{{ url_for('static', filename='js/imagesloaded.pkgd.min.js') }}" type="text/javascript"></script>
  <script src="{{ url_for('static', filename='js/main.js') }}" type="text/javascript"></script>


  </body>
  </html>
